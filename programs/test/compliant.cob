IDENTIFICATION DIVISION.
       PROGRAM-ID. COMPLIANT.
       AUTHOR. Stacktalk Generated.
       DATE-WRITTEN. Generated by Stacktalk.

ENVIRONMENT DIVISION.

DATA DIVISION.
WORKING-STORAGE SECTION.
       01 ACCOUNT-NUMBER.
           02 VALUE PIC 9(10).
       01 TRANSACTION-AMOUNT.
           02 VALUE PIC 9(8)V99.
       01 NSF-FLAG.
           02 VALUE PIC X.
       01 NSF-FEE.
           02 VALUE PIC 9(5)V99.
       01 APPROVAL-CODE.
           02 VALUE PIC X(10).

PROCEDURE DIVISION.
       IF TRANSACTION-AMOUNT > ACCOUNT-BALANCE
           MOVE 'Y' TO NSF-FLAG
           MOVE 25.00 TO NSF-FEE
           PERFORM CHARGE-NSF-FEE
       END-IF
       PERFORM VALIDATE-APPROVAL-CODE
       IF APPROVAL-CODE = 'VALID'
           PERFORM PROCESS-TRANSACTION
       END-IF
       END-IF
       STOP RUN.